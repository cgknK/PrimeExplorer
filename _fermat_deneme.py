import math
import numpy as np
from typing import List, Tuple, Optional


def is_square(n: int) -> bool:
    sqrt_n = math.isqrt(n)
    return sqrt_n * sqrt_n == n


def fermat_factorization(num: int, p: int, q: int) -> Tuple[Optional[int], Optional[int], int]:
    a = np.int64(np.ceil(np.sqrt(num)))  # Daha hızlı karekök alma işlemi
    delta = a * a - num
    count = 0

    for _ in range(10**20):
        if is_square(delta):
            b = np.int64(np.sqrt(delta))
            return [a - b, a + b, count, num, p, q]

        a += 1
        delta = a * a - num
        count += 1

    return [None, None, max_iterations, num, p, q]


result1 = fermat_factorization(53424367 * 1928963, 53424367, 1928963)
result2 = fermat_factorization(1238768169150383, 63633343, 19467281)
print(result1)
print(result2)


"""
Process 17064 -> None None 3056571 103053627241421 53424367 1928963 2024-10-02 16:20:05 max_time15
Process 17064 -> None None 3024554 1238768169150383 63633343 19467281 2024-10-02 16:20:21 max_time15
Process 17064 -> 21474953 25605449 90770 549875813818897 25605449 21474953 2024-10-02 16:20:22
Process 17064 -> None None 3054713 153544374962197 3497479 43901443 2024-10-02 16:20:38 max_time15
Process 17064 -> None None 3047382 380027790858449 44134177 8610737 2024-10-02 16:20:54 max_time15
Process 15660 -> 42104131 60802403 856504 2560032341026793 60802403 42104131 2024-10-02 16:19:54
Process 15660 -> None None 3046550 235420173647591 35138897 6699703 2024-10-02 16:20:10 max_time15
Process 15660 -> 41174999 56172107 581074 2312886449552893 56172107 41174999 2024-10-02 16:20:13
Process 15660 -> 41054743 46171397 75099 1895554837785971 46171397 41054743 2024-10-02 16:20:14
Process 15660 -> None None 3037127 321848265679891 50222537 6408443 2024-10-02 16:20:30 max_time15
Process 15660 -> 60908759 66758287 67039 4066164414135833 66758287 60908759 2024-10-02 16:20:31
Process 15660 -> 21410693 38491163 1243394 824122474205959 38491163 21410693 2024-10-02 16:20:38
Process 15660 -> 29813989 58687457 2421221 1749707197435973 58687457 29813989 2024-10-02 16:20:51
Process 15660 -> 40010147 58966703 916144 2359266455135341 40010147 58966703 2024-10-02 16:20:56
Process 15136 -> 35532463 63923597 2069212 2271362845229411 35532463 63923597 2024-10-02 16:19:59
Process 15136 -> None None 3060289 16293481423523 490309 33231047 2024-10-02 16:20:16 max_time15
Process 15136 -> 37510327 59923517 1306472 2247750717660059 59923517 37510327 2024-10-02 16:20:23
Process 15136 -> 21350143 41301427 1630812 881791372554061 41301427 21350143 2024-10-02 16:20:32
Process 15136 -> 45040859 47084549 11335 2120728532587591 47084549 45040859 2024-10-02 16:20:32
Process 15136 -> None None 3052842 86742990707993 56963237 1522789 2024-10-02 16:20:48 max_time15
Process 15136 -> 35577077 36601379 3634 1302170078989183 36601379 35577077 2024-10-02 16:20:49
Process 15136 -> 24607369 30096107 138028 740586010412483 30096107 24607369 2024-10-02 16:20:50
Process 15136 -> 42112481 42332371 143 1782721169422451 42112481 42332371 2024-10-02 16:20:51
Process 15136 -> 24220327 39421901 921092 954811333181627 24220327 39421901 2024-10-02 16:20:56
Process 11048 -> 1768727 8779409 1333461 15528377742343 1768727 8779409 2024-10-02 16:19:56
Process 11048 -> 18112583 29229329 661856 529418647546807 18112583 29229329 2024-10-02 16:20:00
Process 11048 -> None None 3046057 776381354874737 12651517 61366661 2024-10-02 16:20:16 max_time15
Process 11048 -> 14107241 18116107 125170 255568287430787 14107241 18116107 2024-10-02 16:20:17
Process 11048 -> 29119697 44960141 856695 1309225682997277 29119697 44960141 2024-10-02 16:20:22
Process 11048 -> None None 3050560 18733306626887 328789 56976683 2024-10-02 16:20:38 max_time15
Process 11048 -> 24688817 44021017 1387860 1086826832866889 24688817 44021017 2024-10-02 16:20:46
Process 11048 -> 26956771 53109079 2195783 1431649280623909 53109079 26956771 2024-10-02 16:20:57
Process 18452 -> None None 4024567 631383397723933 14228449 44374717 2024-10-02 16:21:20 max_time20
Process 18452 -> None None 4042939 70473752167787 35362111 1992917 2024-10-02 16:21:41 max_time20
Process 18452 -> 36357359 56843473 1139679 2066678554667807 56843473 36357359 2024-10-02 16:21:47
Process 18452 -> None None 4043400 815400339196697 13696769 59532313 2024-10-02 16:22:09 max_time20
Process 18452 -> 27672893 57083461 2633183 1579664508322673 27672893 57083461 2024-10-02 16:22:23
Process 8140 -> None None 4071524 795120375074539 54253649 14655611 2024-10-02 16:21:20 max_time20
Process 8140 -> 53330099 53526307 90 2854563251414393 53526307 53330099 2024-10-02 16:21:20
Process 8140 -> 12456721 21207707 578645 264178489148747 12456721 21207707 2024-10-02 16:21:24
Process 8140 -> None None 4089090 1037035594970939 54937763 18876553 2024-10-02 16:21:45 max_time20
Process 8140 -> 15321269 20129429 163788 308408396525401 20129429 15321269 2024-10-02 16:21:47
Process 8140 -> None None 4084874 479685050087839 10015661 47893499 2024-10-02 16:22:08 max_time20
Process 8140 -> 50039251 64940653 484850 3249581635570903 64940653 50039251 2024-10-02 16:22:11
Process 8140 -> 23743651 47516519 2041163 1128215643870869 23743651 47516519 2024-10-02 16:22:22
Process 8140 -> 41814761 58182233 674302 2432876167341313 58182233 41814761 2024-10-02 16:22:25
Process 13660 -> 37954549 53875399 695327 2044816471240051 53875399 37954549 2024-10-02 16:21:03
Process 13660 -> None None 4060809 299356040379659 45381929 6596371 2024-10-02 16:21:24 max_time20
Process 13660 -> 10265543 32496083 3116368 333589937368069 32496083 10265543 2024-10-02 16:21:41
Process 13660 -> None None 4072779 613112924709949 12248051 50057999 2024-10-02 16:22:02 max_time20
Process 13660 -> 15399269 29065723 1076152 447590887156487 29065723 15399269 2024-10-02 16:22:08
Process 13660 -> None None 4146889 953271690762763 14617601 65213963 2024-10-02 16:22:29 max_time20
Process 13332 -> 55421029 65127341 195700 3609424254253889 55421029 65127341 2024-10-02 16:21:00
Process 13332 -> 28314983 50111293 1544843 1418900409403019 28314983 50111293 2024-10-02 16:21:08
Process 13332 -> 45052417 47436161 15361 2137113706251137 45052417 47436161 2024-10-02 16:21:09
Process 13332 -> 54484373 57195199 16452 3116244556125227 54484373 57195199 2024-10-02 16:21:09
Process 13332 -> 28556557 37511723 304861 1071205656017711 37511723 28556557 2024-10-02 16:21:12
Process 13332 -> None None 4028042 1182643269012809 19561351 60458159 2024-10-02 16:21:33 max_time20
Process 13332 -> None None 4035958 140912464487219 4264811 33040729 2024-10-02 16:21:54 max_time20
Process 13332 -> 1480781 2749363 97349 4071204492503 2749363 1480781 2024-10-02 16:21:55
Process 13332 -> 50463503 52166431 7064 2632500847267793 50463503 52166431 2024-10-02 16:21:55
Process 13332 -> 18531287 35246963 1331903 653171587231381 35246963 18531287 2024-10-02 16:22:02
Process 13332 -> 32848553 52060583 1101033 1710114819886399 32848553 52060583 2024-10-02 16:22:09
Process 13332 -> None None 4154173 1468456882761191 22460929 65378279 2024-10-02 16:22:30 max_time20
avg_success_rates [68.75, 62.5]
     (True, [35532463, 63923597, 2069212, 2271362845229411, 35532463, 63923597])
     (True, [42104131, 60802403, 856504, 2560032341026793, 60802403, 42104131])
     (True, [1768727, 8779409, 1333461, 15528377742343, 1768727, 8779409])
     (False, [None, None, 3056571, 103053627241421, 53424367, 1928963])
     (False, [None, None, 3046550, 235420173647591, 35138897, 6699703])
     (True, [18112583, 29229329, 661856, 529418647546807, 18112583, 29229329])
     (False, [None, None, 3060289, 16293481423523, 490309, 33231047])
     (False, [None, None, 3046057, 776381354874737, 12651517, 61366661])
     (False, [None, None, 3024554, 1238768169150383, 63633343, 19467281])
     (True, [41174999, 56172107, 581074, 2312886449552893, 56172107, 41174999])
     (True, [41054743, 46171397, 75099, 1895554837785971, 46171397, 41054743])
     (False, [None, None, 3037127, 321848265679891, 50222537, 6408443])
     (True, [37510327, 59923517, 1306472, 2247750717660059, 59923517, 37510327])
     (True, [14107241, 18116107, 125170, 255568287430787, 14107241, 18116107])
     (True, [29119697, 44960141, 856695, 1309225682997277, 29119697, 44960141])
     (True, [21474953, 25605449, 90770, 549875813818897, 25605449, 21474953])
     (False, [None, None, 3050560, 18733306626887, 328789, 56976683])
     (False, [None, None, 3054713, 153544374962197, 3497479, 43901443])
     (True, [21350143, 41301427, 1630812, 881791372554061, 41301427, 21350143])
     (True, [60908759, 66758287, 67039, 4066164414135833, 66758287, 60908759])
     (True, [21410693, 38491163, 1243394, 824122474205959, 38491163, 21410693])
     (True, [45040859, 47084549, 11335, 2120728532587591, 47084549, 45040859])
     (False, [None, None, 3052842, 86742990707993, 56963237, 1522789])
     (True, [29813989, 58687457, 2421221, 1749707197435973, 58687457, 29813989])
     (True, [24688817, 44021017, 1387860, 1086826832866889, 24688817, 44021017])
     (False, [None, None, 3047382, 380027790858449, 44134177, 8610737])
     (True, [26956771, 53109079, 2195783, 1431649280623909, 53109079, 26956771])
     (True, [35577077, 36601379, 3634, 1302170078989183, 36601379, 35577077])
     (True, [24607369, 30096107, 138028, 740586010412483, 30096107, 24607369])
     (True, [42112481, 42332371, 143, 1782721169422451, 42112481, 42332371])
     (True, [40010147, 58966703, 916144, 2359266455135341, 40010147, 58966703])
     (True, [24220327, 39421901, 921092, 954811333181627, 24220327, 39421901])
     (True, [55421029, 65127341, 195700, 3609424254253889, 55421029, 65127341])
     (False, [None, None, 4024567, 631383397723933, 14228449, 44374717])
     (False, [None, None, 4071524, 795120375074539, 54253649, 14655611])
     (True, [37954549, 53875399, 695327, 2044816471240051, 53875399, 37954549])
     (True, [28314983, 50111293, 1544843, 1418900409403019, 28314983, 50111293])
     (False, [None, None, 4060809, 299356040379659, 45381929, 6596371])
     (True, [45052417, 47436161, 15361, 2137113706251137, 45052417, 47436161])
     (True, [54484373, 57195199, 16452, 3116244556125227, 54484373, 57195199])
     (True, [28556557, 37511723, 304861, 1071205656017711, 37511723, 28556557])
     (False, [None, None, 4028042, 1182643269012809, 19561351, 60458159])
     (False, [None, None, 4042939, 70473752167787, 35362111, 1992917])
     (True, [53330099, 53526307, 90, 2854563251414393, 53526307, 53330099])
     (True, [12456721, 21207707, 578645, 264178489148747, 12456721, 21207707])
     (False, [None, None, 4089090, 1037035594970939, 54937763, 18876553])
     (True, [10265543, 32496083, 3116368, 333589937368069, 32496083, 10265543])
     (False, [None, None, 4035958, 140912464487219, 4264811, 33040729])
     (False, [None, None, 4072779, 613112924709949, 12248051, 50057999])
     (True, [36357359, 56843473, 1139679, 2066678554667807, 56843473, 36357359])
     (True, [15321269, 20129429, 163788, 308408396525401, 20129429, 15321269])
     (False, [None, None, 4084874, 479685050087839, 10015661, 47893499])
     (False, [None, None, 4043400, 815400339196697, 13696769, 59532313])
     (True, [1480781, 2749363, 97349, 4071204492503, 2749363, 1480781])
     (True, [50463503, 52166431, 7064, 2632500847267793, 50463503, 52166431])
     (True, [18531287, 35246963, 1331903, 653171587231381, 35246963, 18531287])
     (True, [15399269, 29065723, 1076152, 447590887156487, 29065723, 15399269])
     (True, [32848553, 52060583, 1101033, 1710114819886399, 32848553, 52060583])
     (False, [None, None, 4146889, 953271690762763, 14617601, 65213963])
     (True, [50039251, 64940653, 484850, 3249581635570903, 64940653, 50039251])
     (False, [None, None, 4154173, 1468456882761191, 22460929, 65378279])
     (True, [27672893, 57083461, 2633183, 1579664508322673, 27672893, 57083461])
     (True, [23743651, 47516519, 2041163, 1128215643870869, 23743651, 47516519])
     (True, [41814761, 58182233, 674302, 2432876167341313, 58182233, 41814761])
22 64
0.34375


  -> 
(False, [None, None, 3056571, 103053627241421, 53424367, 1928963])
Bulunamadi 0

(False, [None, None, 3046550, 235420173647591, 35138897, 6699703])
Dogru bulundu 6699703 35138897

(False, [None, None, 3060289, 16293481423523, 490309, 33231047])
Bulunamadi 0

(False, [None, None, 3046057, 776381354874737, 12651517, 61366661])
Dogru bulundu 12651517 61366661

(False, [None, None, 3024554, 1238768169150383, 63633343, 19467281])
Dogru bulundu 19467281 63633343

(False, [None, None, 3037127, 321848265679891, 50222537, 6408443])
Bulunamadi 0

(False, [None, None, 3050560, 18733306626887, 328789, 56976683])
Bulunamadi 0

(False, [None, None, 3054713, 153544374962197, 3497479, 43901443])
Bulunamadi 0

(False, [None, None, 3052842, 86742990707993, 56963237, 1522789])
Bulunamadi 0

(False, [None, None, 3047382, 380027790858449, 44134177, 8610737])
Dogru bulundu 8610737 44134177

(False, [None, None, 4024567, 631383397723933, 14228449, 44374717])
Dogru bulundu 14228449 44374717

(False, [None, None, 4071524, 795120375074539, 54253649, 14655611])
Dogru bulundu 14655611 54253649

(False, [None, None, 4060809, 299356040379659, 45381929, 6596371])
Bulunamadi 0

(False, [None, None, 4028042, 1182643269012809, 19561351, 60458159])
Dogru bulundu 19561351 60458159

(False, [None, None, 4042939, 70473752167787, 35362111, 1992917])
Bulunamadi 0

(False, [None, None, 4089090, 1037035594970939, 54937763, 18876553])
Dogru bulundu 18876553 54937763

(False, [None, None, 4035958, 140912464487219, 4264811, 33040729])
Bulunamadi 0

(False, [None, None, 4072779, 613112924709949, 12248051, 50057999])
Dogru bulundu 12248051 50057999

(False, [None, None, 4084874, 479685050087839, 10015661, 47893499])
Dogru bulundu 10015661 47893499

(False, [None, None, 4043400, 815400339196697, 13696769, 59532313])
Dogru bulundu 13696769 59532313

(False, [None, None, 4146889, 953271690762763, 14617601, 65213963])
Dogru bulundu 14617601 65213963

(False, [None, None, 4154173, 1468456882761191, 22460929, 65378279])
Dogru bulundu 22460929 65378279

[Finished in 234.5s]
"""